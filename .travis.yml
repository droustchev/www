language: node_js
node_js:
- node

addons:
  apt:
    packages:
    - graphicsmagick

cache:
  bundler: true
  yarn: true
  directories:
  - node_modules
  - vendor/bundle
  - $HOME/.rvm/user/installs

before_install:
- if [[ ! -d $HOME/.rvm/user/installs ]]; then rvm install ruby-2.3.1; fi
- rvm use 2.3.1
- bundle install --deployment

before_script:
- export PATH="$(yarn bin):$PATH"

script:
- yarn run lint
- yarn run build
- bundle exec htmlproofer ./public --check-favicon --check-html --check-external-hash --check-html --check-img-http --check-opengraph

deploy:
  provider: pages
  skip_cleanup: true
  local_dir: public
  github_token: $GH_TOKEN
  repo: zulu-zsh/zulu-zsh.github.io
  target_branch: master
  on:
    branch: master

notifications:
  email: false

env:
  global:
    secure: C9SuXL1N+8dFwrJ3KDSHqx4QJfXGMpoXioEyHm0SuIVHFgf482LU6FFRomcD+pAGN7TTO5o3mSmYQHZZPejPraVmmgjkYeDWCfdYOgihd2NO49bMZkCGjV0yiV9vPkrCgO8z/v/jlety7F1j4W9KHxal8FM+QBNuSyprTPPwkczeAHheWRVpEfuO9F8ITWO6/FPxhgyZYi+CHTKAsOcX2LKh7bTyqA/L0FfcZDJ5xk/tT04rKw7DptP2x6KKcCA7dymewZRgU1LChi9MXKkOZfD3l9i3mNAZXQheHhfqkuMJBu8c2H1MeIa4XmC8nnAUeskwTqD3CQ6SlNDCWdUM8DPU6wPK8ITjQgncic5/4UwWB765hhfqyGjfyFXRaL2Xjq+9Ua9ytb1yWEG5c+VwTGgxEjMQD/MJIaClSx+wcpnnHvAXs3xzFTIJPTHcJrsWeCKHU070PJvKlqbm8oUPQ8H+7a9kCQXszwtW5L+y2IihQidKzBIZVfknIKrPFj6FgrWT41oEOZTs4RV/eiumKexniQXfxQjt6OlFS4v26/s3mRAg15Ik8KjoBK/Pg7oxMxkQRtFsKyYNs9mA4Fd/bWrbhvRe5gIsS8jOVYAgkm+djoWI/T0SgoJU2iJxQhiVc0Zms+N/uQNEyzfzlZSVQNKJ64lzHc0mLPM+dzqIOdc=
